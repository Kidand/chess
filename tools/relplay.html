<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>中国象棋 · 回放</title>
  <style>
    :root { --bg:#f7f3e8; --line:#7b5b34; --red:#c03a2b; --black:#2c3e50; --hilite:#ffd54f; --sel:#4fc3f7; }
    html,body{ height:100%; margin:0; }
    body{ display:flex; flex-direction:column; align-items:center; gap:10px; background:var(--bg); font-family:system-ui,-apple-system,Segoe UI,Roboto; }
    h1{ font-size:20px; margin:10px 0 0; color:#5b4632; }
    .wrap{ display:flex; gap:16px; flex-wrap:wrap; justify-content:center; align-items:flex-start; margin: 0 12px 20px; }
    .panel{ min-width:300px; background:#fff; border-radius:12px; padding:12px; box-shadow:0 8px 22px rgba(0,0,0,.12); }
    .row{ display:flex; align-items:center; justify-content:space-between; gap:8px; margin:8px 0; }
    label{ font-size:14px; color:#3d2f22; }
    select,button,input{ font-size:14px; padding:8px 10px; border-radius:8px; border:1px solid #d7c9b8; background:#fff; }
    button{ cursor:pointer; }
    .badge{ padding:2px 6px; border-radius:6px; font-size:12px; background:#eee; }
    .hint{ color:#6b543e; font-size:12px; }
    .footer{ color:#7a6a56; font-size:12px; margin-bottom:10px; }

    /* Board grid */
    .board{ display:grid; grid-template-columns: repeat(9, 56px); grid-template-rows: repeat(10, 56px); gap:2px; background:#d9c4a6; padding:8px; border-radius:8px; box-shadow:0 10px 30px rgba(0,0,0,.15); }
    .sq{ width:56px; height:56px; display:flex; align-items:center; justify-content:center; background:#f7ebd9; border-radius:6px; position:relative; font-weight:700; font-size:24px; color:#2c3e50; }
    .sq:nth-child(odd){ background:#fff4e4; }
    .piece.red{ color: var(--red); }
    .piece.black{ color: var(--black); }
    .hl::after{ content:''; position:absolute; inset:2px; border:2px solid var(--sel); border-radius:6px; pointer-events:none; }
    .mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; }
  </style>
</head>
<body>
  <h1>中国象棋 · 回放</h1>
  <div class="wrap">
    <canvas id="board" width="540" height="600"></canvas>
    <div class="panel">
      <div class="row"><label>结果：</label>
        <span><span id="result" class="badge"></span> 原因 <span id="reason" class="badge"></span></span>
      </div>
      <div class="row"><label>对局信息：</label>
        <span class="mono">Seg <span id="seg"></span> · Rank <span id="rank"></span> · Idx <span id="idx"></span></span>
      </div>
      <div class="row"><label>步数 / 吃子：</label>
        <span class="mono"><span id="plies"></span> / <span id="caps"></span></span>
      </div>
      <div class="row"><label>时间：</label>
        <span id="timestamp" class="mono"></span>
      </div>
      <div class="row" style="justify-content:flex-start; gap:8px;">
        <button id="btnStart">开始</button>
        <button id="btnPause">暂停</button>
        <button id="btnPrev">上一步</button>
        <button id="btnNext">下一步</button>
      </div>
      <div class="row"><label>进度：</label>
        <span class="mono">第 <span id="step">0</span> 步 / 共 <span id="total"></span> 步</span>
      </div>
      <div class="hint">提示：点击“开始”后每 5 秒自动前进一步，可随时“暂停”。</div>
    </div>
  </div>

  <script>
  const payload = {"meta": {"timestamp": "2025-08-10T03:37:27.473022Z", "seg": 1, "rank": 7, "idx": 60, "result": 1, "winner": null, "reason": 2, "plies": 233, "caps": 26}, "states": ["rheakaehr/9/1c5c1/s1s1s1s1s/9/9/S1S1S1S1S/1C5C1/9/RHEAKAEHR r", "rheakaehr/9/1c5c1/s1s1s1s1s/9/9/S1S1S1S1S/1C1C5/9/RHEAKAEHR b", "rheaka1hr/9/1c2e2c1/s1s1s1s1s/9/9/S1S1S1S1S/1C1C5/9/RHEAKAEHR r", "rheaka1hr/9/1c2e2c1/s1s1s1s1s/9/9/S1S1S1S1S/1C1C4H/9/RHEAKAE1R b", "r1eaka1hr/9/hc2e2c1/s1s1s1s1s/9/9/S1S1S1S1S/1C1C4H/9/RHEAKAE1R r", "r1eaka1hr/9/hc1Ce2c1/s1s1s1s1s/9/9/S1S1S1S1S/1C6H/9/RHEAKAE1R b", "r1eaka1hr/7c1/hc1Ce4/s1s1s1s1s/9/9/S1S1S1S1S/1C6H/9/RHEAKAE1R r", "r1eaka1hr/7c1/hc1Ce4/s1s1s1s1s/9/2S6/S3S1S1S/1C6H/9/RHEAKAE1R b", "rheaka1hr/7c1/1c1Ce4/s1s1s1s1s/9/2S6/S3S1S1S/1C6H/9/RHEAKAE1R r", "rheaka1hr/7c1/1c1Ce4/sCs1s1s1s/9/2S6/S3S1S1S/8H/9/RHEAKAE1R b", "rheaka1h1/7c1/1c1Ce3r/sCs1s1s1s/9/2S6/S3S1S1S/8H/9/RHEAKAE1R r", "rheaka1h1/7c1/1c1Ce3r/s1s1s1s1s/9/1CS6/S3S1S1S/8H/9/RHEAKAE1R b", "rheaka1h1/7c1/3Ce3r/s1s1s1s1s/1c7/1CS6/S3S1S1S/8H/9/RHEAKAE1R r", "rheaka1h1/7c1/3Ce3r/s1s1s1s1s/1c7/1CS6/S3S1S1S/8H/4A4/RHEAK1E1R b", "rheaka1h1/9/3Ce3r/s1s1s1s1s/1c5c1/1CS6/S3S1S1S/8H/4A4/RHEAK1E1R r", "rheaka1h1/9/3Ce3r/s1s1s1s1s/1c5c1/C1S6/S3S1S1S/8H/4A4/RHEAK1E1R b", "rheaka1h1/9/3Ce3r/s1s1s1s1s/1c7/C1S6/S3S1S1S/8H/4A2c1/RHEAK1E1R r", "rheaka1h1/9/3Ce3r/s1s1s1s1s/1c7/C1S6/S3S1S1S/E7H/4A2c1/RH1AK1E1R b", "rheaka1h1/9/3Ce3r/s1s1s1s1s/c8/C1S6/S3S1S1S/E7H/4A2c1/RH1AK1E1R r", "rheaka1h1/9/C3e3r/s1s1s1s1s/c8/C1S6/S3S1S1S/E7H/4A2c1/RH1AK1E1R b", "rheaka1h1/9/C3e2cr/s1s1s1s1s/c8/C1S6/S3S1S1S/E7H/4A4/RH1AK1E1R r", "rheaka1h1/9/C3e2cr/s1s1s1s1s/c8/C1S3S2/S3S3S/E7H/4A4/RH1AK1E1R b", "rheaka1h1/9/C3e2cr/s1s1s1s1s/5c3/C1S3S2/S3S3S/E7H/4A4/RH1AK1E1R r", "rheaka1h1/9/C3e2cr/s1s1s1s1s/5cS2/C1S6/S3S3S/E7H/4A4/RH1AK1E1R b", "1heaka1h1/9/r3e2cr/s1s1s1s1s/5cS2/C1S6/S3S3S/E7H/4A4/RH1AK1E1R r", "1heaka1h1/9/r3e2cr/s1s1s1s1s/5cS2/1CS6/S3S3S/E7H/4A4/RH1AK1E1R b", "1heaka1h1/9/r3e2cr/s1s1s3s/5cs2/1CS6/S3S3S/E7H/4A4/RH1AK1E1R r", "1heaka1h1/9/r3e2cr/s1s1s3s/5cs2/C1S6/S3S3S/E7H/4A4/RH1AK1E1R b", "1heaka1h1/7c1/r3e3r/s1s1s3s/5cs2/C1S6/S3S3S/E7H/4A4/RH1AK1E1R r", "1heaka1h1/7c1/C3e3r/s1s1s3s/5cs2/2S6/S3S3S/E7H/4A4/RH1AK1E1R b", "1heaka1h1/7c1/C3e2r1/s1s1s3s/5cs2/2S6/S3S3S/E7H/4A4/RH1AK1E1R r", "1heaka1h1/7c1/C3e2r1/s1s1s3s/5cs2/2S6/S3S3S/E7H/4A4/RH1AK1ER1 b", "1heaka1h1/7c1/C3e3r/s1s1s3s/5cs2/2S6/S3S3S/E7H/4A4/RH1AK1ER1 r", "1heaka1h1/7c1/4e3C/s1s1s3s/5cs2/2S6/S3S3S/E7H/4A4/RH1AK1ER1 b", "1hea1a1h1/4k2c1/4e3C/s1s1s3s/5cs2/2S6/S3S3S/E7H/4A4/RH1AK1ER1 r", "1hea1a1h1/4k2c1/4e3C/s1s1s3s/5cs2/2S6/S3S3S/E7H/3HA4/R2AK1ER1 b", "1hea1a1h1/4k1c2/4e3C/s1s1s3s/5cs2/2S6/S3S3S/E7H/3HA4/R2AK1ER1 r", "1hea1a1h1/4k1c2/4e3C/s1s1s3s/5cs2/2S5S/S3S4/E7H/3HA4/R2AK1ER1 b", "1hea1a1h1/4k1c2/4e3C/s1s1s3s/6s2/2S5S/S3Sc3/E7H/3HA4/R2AK1ER1 r", "1hea1a1hC/4k1c2/4e4/s1s1s3s/6s2/2S5S/S3Sc3/E7H/3HA4/R2AK1ER1 b", "1hea1a1hC/4k1c2/4e4/s1s1s3s/5cs2/2S5S/S3S4/E7H/3HA4/R2AK1ER1 r", "1hea1a1hC/4k1c2/4e4/s1s1s3s/5cs2/2S5S/S1H1S4/E7H/4A4/R2AK1ER1 b", "1hea1a1hC/4k4/4e4/s1s1s3s/5cs2/2S5S/S1H1S4/E7H/4A4/R2AK1cR1 r", "1hea1a1hC/4k4/4e4/s1s1s3s/5cs2/2S5S/S1H1S4/E7H/4A4/R2AK1R2 b", "1hea1a1hC/4k4/4e4/s1s1s4/5cs1s/2S5S/S1H1S4/E7H/4A4/R2AK1R2 r", "1hea1a1hC/4k4/4e4/s1s1s4/5cs1s/2S5S/S1H1S4/E7H/4A4/R2AK3R b", "1heaka1hC/9/4e4/s1s1s4/5cs1s/2S5S/S1H1S4/E7H/4A4/R2AK3R r", "1heaka1hC/9/4e4/s1s1s4/5cs1s/2S5S/S1H1S4/E7H/4A4/R2AK2R1 b", "1heaka1hC/9/4e4/s1s1s4/3c2s1s/2S5S/S1H1S4/E7H/4A4/R2AK2R1 r", "1heaka1hC/9/4e4/s1s1s4/3c2s1s/2S5S/S1H1S4/E6RH/4A4/R2AK4 b", "1heaka1hC/9/3ce4/s1s1s4/6s1s/2S5S/S1H1S4/E6RH/4A4/R2AK4 r", "1heakC1h1/9/3ce4/s1s1s4/6s1s/2S5S/S1H1S4/E6RH/4A4/R2AK4 b", "1hea1k1h1/9/3ce4/s1s1s4/6s1s/2S5S/S1H1S4/E6RH/4A4/R2AK4 r", "1hea1k1h1/9/3ce4/s1s1s4/6s1s/S1S5S/2H1S4/E6RH/4A4/R2AK4 b", "1hea1k1h1/9/4e4/s1s1s4/6s1s/S1S5S/2H1S4/E6RH/3cA4/R2AK4 r", "1hea1k1R1/9/4e4/s1s1s4/6s1s/S1S5S/2H1S4/E7H/3cA4/R2AK4 b", "1hea3R1/5k3/4e4/s1s1s4/6s1s/S1S5S/2H1S4/E7H/3cA4/R2AK4 r", "1heR5/5k3/4e4/s1s1s4/6s1s/S1S5S/2H1S4/E7H/3cA4/R2AK4 b", "1heR5/5k3/4e4/s1s1s4/8s/S1S3s1S/2H1S4/E7H/3cA4/R2AK4 r", "1he6/5k3/4e4/s1sRs4/8s/S1S3s1S/2H1S4/E7H/3cA4/R2AK4 b", "1he6/5k3/4e4/s1sRs4/8s/S1S3s1S/2H1S4/E7H/c3A4/R2AK4 r", "1he6/5k3/4e4/s1s1R4/8s/S1S3s1S/2H1S4/E7H/c3A4/R2AK4 b", "2e6/5k3/h3e4/s1s1R4/8s/S1S3s1S/2H1S4/E7H/c3A4/R2AK4 r", "2e6/5k3/h3R4/s1s6/8s/S1S3s1S/2H1S4/E7H/c3A4/R2AK4 b", "9/5k3/h3e4/s1s6/8s/S1S3s1S/2H1S4/E7H/c3A4/R2AK4 r", "9/5k3/h3e4/s1s6/8s/S1S3s1S/2H1S4/E7H/c8/R2AKA3 b", "9/5k3/h3e4/s1s6/8s/S1S3s1S/2H1S4/E7H/6c2/R2AKA3 r", "9/5k3/h3e4/s1s6/8s/S1S3s1S/2H1S4/E7H/4A1c2/R3KA3 b", "9/5k3/h8/s1s6/6e1s/S1S3s1S/2H1S4/E7H/4A1c2/R3KA3 r", "9/5k3/h8/s1s6/6e1s/S1S3s1S/2H1S4/8H/4A1c2/R1E1KA3 b", "9/9/h4k3/s1s6/6e1s/S1S3s1S/2H1S4/8H/4A1c2/R1E1KA3 r", "9/9/h4k3/s1s6/6e1s/S1S3s1S/4S4/4H3H/4A1c2/R1E1KA3 b", "9/2h6/5k3/s1s6/6e1s/S1S3s1S/4S4/4H3H/4A1c2/R1E1KA3 r", "9/2h6/5k3/s1s6/2S3e1s/S5s1S/4S4/4H3H/4A1c2/R1E1KA3 b", "4h4/9/5k3/s1s6/2S3e1s/S5s1S/4S4/4H3H/4A1c2/R1E1KA3 r", "4h4/9/5k3/s1s6/2S3e1s/S5s1S/4S4/4H4/4A1H2/R1E1KA3 b", "4h4/9/4k4/s1s6/2S3e1s/S5s1S/4S4/4H4/4A1H2/R1E1KA3 r", "4h4/9/4k4/s1s6/2S3e1s/S5s1S/4S4/4H4/4A1H2/1RE1KA3 b", "4h4/9/4k4/s8/2s3e1s/S5s1S/4S4/4H4/4A1H2/1RE1KA3 r", "4h4/9/4k4/s8/2s3e1s/S5s1S/4S4/E3H4/4A1H2/1R2KA3 b", "4h4/9/4k4/s8/2s3e1s/S6sS/4S4/E3H4/4A1H2/1R2KA3 r", "4h4/9/4k4/s8/2s3e1s/S6sS/4S4/E3H3H/4A4/1R2KA3 b", "9/2h6/4k4/s8/2s3e1s/S6sS/4S4/E3H3H/4A4/1R2KA3 r", "9/2h6/4k4/s8/2s3e1s/S6HS/4S4/E3H4/4A4/1R2KA3 b", "9/2h6/5k3/s8/2s3e1s/S6HS/4S4/E3H4/4A4/1R2KA3 r", "9/2h6/5k3/s8/2s3e1s/S6HS/4S4/E3HA3/9/1R2KA3 b", "9/9/h4k3/s8/2s3e1s/S6HS/4S4/E3HA3/9/1R2KA3 r", "9/9/h4k3/s8/2s3e1s/S1E4HS/4S4/4HA3/9/1R2KA3 b", "9/9/h4k3/s8/6e1s/S1s4HS/4S4/4HA3/9/1R2KA3 r", "9/9/h4k3/s8/6e1s/S1s4HS/4S4/4HA3/1R7/4KA3 b", "1h7/9/5k3/s8/6e1s/S1s4HS/4S4/4HA3/1R7/4KA3 r", "1h7/9/5k3/s8/6e1s/S1s4HS/4S4/4HA3/8R/4KA3 b", "9/9/2h2k3/s8/6e1s/S1s4HS/4S4/4HA3/8R/4KA3 r", "9/9/2h2k3/s8/6e1s/S1s4HS/4S4/4HA3/9/4KA2R b", "9/9/2h2k2e/s8/8s/S1s4HS/4S4/4HA3/9/4KA2R r", "9/9/2h2k2e/s8/8s/S1s4HS/4S4/4HA3/4K4/5A2R b", "9/9/2h1k3e/s8/8s/S1s4HS/4S4/4HA3/4K4/5A2R r", "9/9/2h1k3e/s8/5H2s/S1s5S/4S4/4HA3/4K4/5A2R b", "9/9/2h2k2e/s8/5H2s/S1s5S/4S4/4HA3/4K4/5A2R r", "9/9/2h2k2e/s2H5/8s/S1s5S/4S4/4HA3/4K4/5A2R b", "9/9/2h1k3e/s2H5/8s/S1s5S/4S4/4HA3/4K4/5A2R r", "9/9/2h1k3e/s2H5/8s/S1s5S/4S4/4HA2R/4K4/5A3 b", "9/h8/4k3e/s2H5/8s/S1s5S/4S4/4HA2R/4K4/5A3 r", "9/h8/4k3e/s2H5/S7s/2s5S/4S4/4HA2R/4K4/5A3 b", "2h6/9/4k3e/s2H5/S7s/2s5S/4S4/4HA2R/4K4/5A3 r", "2h6/4H4/4k3e/s8/S7s/2s5S/4S4/4HA2R/4K4/5A3 b", "2h6/4H4/4k3e/9/s7s/2s5S/4S4/4HA2R/4K4/5A3 r", "2H6/9/4k3e/9/s7s/2s5S/4S4/4HA2R/4K4/5A3 b", "2H6/9/5k2e/9/s7s/2s5S/4S4/4HA2R/4K4/5A3 r", "9/9/1H3k2e/9/s7s/2s5S/4S4/4HA2R/4K4/5A3 b", "9/9/1H2k3e/9/s7s/2s5S/4S4/4HA2R/4K4/5A3 r", "9/9/4k3e/9/s1H5s/2s5S/4S4/4HA2R/4K4/5A3 b", "9/9/4k3e/9/2H5s/s1s5S/4S4/4HA2R/4K4/5A3 r", "9/9/4k3e/9/2H5s/s1s5S/4S4/4HAR2/4K4/5A3 b", "9/9/4k3e/9/2H5s/s2s4S/4S4/4HAR2/4K4/5A3 r", "9/9/4k3e/9/2H5S/s2s5/4S4/4HAR2/4K4/5A3 b", "9/9/4k3e/9/2H5S/s3s4/4S4/4HAR2/4K4/5A3 r", "9/9/4k3e/9/2H5S/s3s4/4S4/4HAR2/9/4KA3 b", "9/9/4k3e/9/2H5S/s8/4s4/4HAR2/9/4KA3 r", "9/9/4k3e/9/8S/H8/4s4/4HAR2/9/4KA3 b", "9/9/4k4/9/6e1S/H8/4s4/4HAR2/9/4KA3 r", "9/9/4k4/9/6e1S/H8/4s4/4H1R2/4A4/4KA3 b", "9/9/4k4/9/6e1S/H8/5s3/4H1R2/4A4/4KA3 r", "9/9/4k4/9/6e1S/H8/5s3/6R2/2H1A4/4KA3 b", "9/9/4k3e/9/8S/H8/5s3/6R2/2H1A4/4KA3 r", "9/9/4k3e/9/8S/H8/5s3/H5R2/4A4/4KA3 b", "6e2/9/4k4/9/8S/H8/5s3/H5R2/4A4/4KA3 r", "6e2/9/4k4/9/8S/H8/5s3/H1R6/4A4/4KA3 b", "6e2/4k4/9/9/8S/H8/5s3/H1R6/4A4/4KA3 r", "6e2/2R1k4/9/9/8S/H8/5s3/H8/4A4/4KA3 b", "4k1e2/2R6/9/9/8S/H8/5s3/H8/4A4/4KA3 r", "4k1e2/1R7/9/9/8S/H8/5s3/H8/4A4/4KA3 b", "4k1e2/1R7/9/9/8S/H8/9/H4s3/4A4/4KA3 r", "4k1e2/9/9/9/8S/H8/1R7/H4s3/4A4/4KA3 b", "4k1e2/9/9/9/8S/H8/1R7/H5s2/4A4/4KA3 r", "4k1e2/9/9/9/8S/H8/1R7/H5s2/4A4/3K1A3 b", "4k1e2/9/9/9/8S/H8/1R7/H6s1/4A4/3K1A3 r", "4k1e2/9/9/1H7/8S/9/1R7/H6s1/4A4/3K1A3 b", "5ke2/9/9/1H7/8S/9/1R7/H6s1/4A4/3K1A3 r", "5ke2/9/9/1H7/8S/9/1R7/H4A1s1/9/3K1A3 b", "4k1e2/9/9/1H7/8S/9/1R7/H4A1s1/9/3K1A3 r", "4k1e2/H8/9/9/8S/9/1R7/H4A1s1/9/3K1A3 b", "4k4/H8/4e4/9/8S/9/1R7/H4A1s1/9/3K1A3 r", "4k4/H8/4e4/9/8S/9/1R7/5A1s1/9/1H1K1A3 b", "4k4/H8/9/9/6e1S/9/1R7/5A1s1/9/1H1K1A3 r", "4k4/H8/9/8S/6e2/9/1R7/5A1s1/9/1H1K1A3 b", "4k4/H8/9/8S/6e2/9/1R7/5A3/7s1/1H1K1A3 r", "4k4/H8/9/8S/6e2/9/2R6/5A3/7s1/1H1K1A3 b", "4k4/H8/9/8S/6e2/9/2R6/5A3/6s2/1H1K1A3 r", "4k4/H8/9/8S/6e2/9/1R7/5A3/6s2/1H1K1A3 b", "4k4/H8/4e4/8S/9/9/1R7/5A3/6s2/1H1K1A3 r", "4k4/H8/4e4/8S/9/9/7R1/5A3/6s2/1H1K1A3 b", "2e1k4/H8/9/8S/9/9/7R1/5A3/6s2/1H1K1A3 r", "2e1k4/H8/9/8S/9/9/4R4/5A3/6s2/1H1K1A3 b", "4k4/H8/4e4/8S/9/9/4R4/5A3/6s2/1H1K1A3 r", "4k4/H8/4e4/8S/4R4/9/9/5A3/6s2/1H1K1A3 b", "4k4/H8/4e4/8S/4R4/9/9/5A3/9/1H1K1As2 r", "4k4/H8/4e4/8S/4R4/9/9/5A3/3K5/1H3As2 b", "4k4/H8/4e4/8S/4R4/9/9/5A3/3K5/1H3s3 r", "4k4/H8/4e4/8S/4R4/9/9/9/3KA4/1H3s3 b", "5k3/H8/4e4/8S/4R4/9/9/9/3KA4/1H3s3 r", "5k3/H8/4R4/8S/9/9/9/9/3KA4/1H3s3 b", "9/H4k3/4R4/8S/9/9/9/9/3KA4/1H3s3 r", "9/H4k3/3R5/8S/9/9/9/9/3KA4/1H3s3 b", "9/H4k3/3R5/8S/9/9/9/9/3KA4/1H2s4 r", "9/H4k3/3R5/8S/9/9/9/2H6/3KA4/4s4 b", "9/H3k4/3R5/8S/9/9/9/2H6/3KA4/4s4 r", "9/H3k4/9/8S/9/9/9/2HR5/3KA4/4s4 b", "4k4/H8/9/8S/9/9/9/2HR5/3KA4/4s4 r", "4k4/H8/9/7S1/9/9/9/2HR5/3KA4/4s4 b", "4k4/H8/9/7S1/9/9/9/2HR5/3KA4/5s3 r", "4k4/H8/9/7S1/9/9/9/2H1R4/3KA4/5s3 b", "5k3/H8/9/7S1/9/9/9/2H1R4/3KA4/5s3 r", "5k3/H8/9/7S1/9/9/H8/4R4/3KA4/5s3 b", "5k3/H8/9/7S1/9/9/H8/4R4/3KA4/6s2 r", "5k3/H8/9/7S1/9/9/H8/7R1/3KA4/6s2 b", "4k4/H8/9/7S1/9/9/H8/7R1/3KA4/6s2 r", "4k4/H8/9/7S1/1H7/9/9/7R1/3KA4/6s2 b", "5k3/H8/9/7S1/1H7/9/9/7R1/3KA4/6s2 r", "5k3/H8/7S1/9/1H7/9/9/7R1/3KA4/6s2 b", "9/H4k3/7S1/9/1H7/9/9/7R1/3KA4/6s2 r", "9/H4k3/7S1/9/1H7/9/9/2R6/3KA4/6s2 b", "9/H4k3/7S1/9/1H7/9/9/2R6/3KA4/5s3 r", "9/H4k3/7S1/9/1H7/9/9/2R6/3K5/5A3 b", "9/H3k4/7S1/9/1H7/9/9/2R6/3K5/5A3 r", "9/H3k4/7S1/9/1H7/9/9/2R6/9/3K1A3 b", "9/H8/4k2S1/9/1H7/9/9/2R6/9/3K1A3 r", "9/H8/2H1k2S1/9/9/9/9/2R6/9/3K1A3 b", "9/H8/2H2k1S1/9/9/9/9/2R6/9/3K1A3 r", "9/H6S1/2H2k3/9/9/9/9/2R6/9/3K1A3 b", "9/H6S1/2H1k4/9/9/9/9/2R6/9/3K1A3 r", "9/H6S1/2H1k4/9/9/9/9/4R4/9/3K1A3 b", "9/H6S1/2H2k3/9/9/9/9/4R4/9/3K1A3 r", "1H7/H6S1/5k3/9/9/9/9/4R4/9/3K1A3 b", "1H7/H4k1S1/9/9/9/9/9/4R4/9/3K1A3 r", "9/H4k1S1/2H6/9/9/9/9/4R4/9/3K1A3 b", "9/H6S1/2H2k3/9/9/9/9/4R4/9/3K1A3 r", "9/H6S1/2H2k3/9/9/4R4/9/9/9/3K1A3 b", "9/H4k1S1/2H6/9/9/4R4/9/9/9/3K1A3 r", "2H6/5k1S1/2H6/9/9/4R4/9/9/9/3K1A3 b", "2H6/7S1/2H2k3/9/9/4R4/9/9/9/3K1A3 r", "2H6/7S1/2H2k3/9/9/8R/9/9/9/3K1A3 b", "2H6/7S1/2H1k4/9/9/8R/9/9/9/3K1A3 r", "9/4H2S1/2H1k4/9/9/8R/9/9/9/3K1A3 b", "9/4H2S1/2H2k3/9/9/8R/9/9/9/3K1A3 r", "9/4H2S1/2H2k3/9/9/1R7/9/9/9/3K1A3 b", "9/4H2S1/2H1k4/9/9/1R7/9/9/9/3K1A3 r", "9/H3H2S1/4k4/9/9/1R7/9/9/9/3K1A3 b", "9/H3H2S1/5k3/9/9/1R7/9/9/9/3K1A3 r", "2H6/H6S1/5k3/9/9/1R7/9/9/9/3K1A3 b", "2H6/H6S1/4k4/9/9/1R7/9/9/9/3K1A3 r", "2H6/H6S1/4k4/9/9/7R1/9/9/9/3K1A3 b", "2H6/H6S1/5k3/9/9/7R1/9/9/9/3K1A3 r", "2H6/H6S1/5k3/9/9/6R2/9/9/9/3K1A3 b", "2H6/H6S1/4k4/9/9/6R2/9/9/9/3K1A3 r", "9/H6S1/3Hk4/9/9/6R2/9/9/9/3K1A3 b", "9/H6S1/3H1k3/9/9/6R2/9/9/9/3K1A3 r", "9/H6S1/5k3/9/2H6/6R2/9/9/9/3K1A3 b", "9/H4k1S1/9/9/2H6/6R2/9/9/9/3K1A3 r", "9/H4k1S1/3H5/9/9/6R2/9/9/9/3K1A3 b", "9/H6S1/3H1k3/9/9/6R2/9/9/9/3K1A3 r", "9/7S1/3H1k3/1H7/9/6R2/9/9/9/3K1A3 b", "9/7S1/3Hk4/1H7/9/6R2/9/9/9/3K1A3 r", "9/7S1/3Hk4/1H7/9/9/9/6R2/9/3K1A3 b", "9/7S1/3H1k3/1H7/9/9/9/6R2/9/3K1A3 r", "9/7S1/3H1k3/1H7/9/9/9/7R1/9/3K1A3 b", "9/7S1/3Hk4/1H7/9/9/9/7R1/9/3K1A3 r", "9/7S1/3Hk4/1H7/9/9/9/3R5/9/3K1A3 b", "9/4k2S1/3H5/1H7/9/9/9/3R5/9/3K1A3 r", "4H4/4k2S1/9/1H7/9/9/9/3R5/9/3K1A3 b", "4k4/7S1/9/1H7/9/9/9/3R5/9/3K1A3 r", "4k4/7S1/3H5/9/9/9/9/3R5/9/3K1A3 b", "5k3/7S1/3H5/9/9/9/9/3R5/9/3K1A3 r", "5k1S1/9/3H5/9/9/9/9/3R5/9/3K1A3 b"], "moves": [{"fr": 7, "fc": 7, "tr": 7, "tc": 3, "fallback": 0}, {"fr": 0, "fc": 6, "tr": 2, "tc": 4, "fallback": 0}, {"fr": 9, "fc": 7, "tr": 7, "tc": 8, "fallback": 0}, {"fr": 0, "fc": 1, "tr": 2, "tc": 0, "fallback": 0}, {"fr": 7, "fc": 3, "tr": 2, "tc": 3, "fallback": 0}, {"fr": 2, "fc": 7, "tr": 1, "tc": 7, "fallback": 0}, {"fr": 6, "fc": 2, "tr": 5, "tc": 2, "fallback": 0}, {"fr": 2, "fc": 0, "tr": 0, "tc": 1, "fallback": 0}, {"fr": 7, "fc": 1, "tr": 3, "tc": 1, "fallback": 0}, {"fr": 0, "fc": 8, "tr": 2, "tc": 8, "fallback": 0}, {"fr": 3, "fc": 1, "tr": 5, "tc": 1, "fallback": 0}, {"fr": 2, "fc": 1, "tr": 4, "tc": 1, "fallback": 0}, {"fr": 9, "fc": 5, "tr": 8, "tc": 4, "fallback": 0}, {"fr": 1, "fc": 7, "tr": 4, "tc": 7, "fallback": 0}, {"fr": 5, "fc": 1, "tr": 5, "tc": 0, "fallback": 0}, {"fr": 4, "fc": 7, "tr": 8, "tc": 7, "fallback": 0}, {"fr": 9, "fc": 2, "tr": 7, "tc": 0, "fallback": 0}, {"fr": 4, "fc": 1, "tr": 4, "tc": 0, "fallback": 0}, {"fr": 2, "fc": 3, "tr": 2, "tc": 0, "fallback": 0}, {"fr": 8, "fc": 7, "tr": 2, "tc": 7, "fallback": 0}, {"fr": 6, "fc": 6, "tr": 5, "tc": 6, "fallback": 0}, {"fr": 4, "fc": 0, "tr": 4, "tc": 5, "fallback": 0}, {"fr": 5, "fc": 6, "tr": 4, "tc": 6, "fallback": 0}, {"fr": 0, "fc": 0, "tr": 2, "tc": 0, "fallback": 0}, {"fr": 5, "fc": 0, "tr": 5, "tc": 1, "fallback": 0}, {"fr": 3, "fc": 6, "tr": 4, "tc": 6, "fallback": 0}, {"fr": 5, "fc": 1, "tr": 5, "tc": 0, "fallback": 0}, {"fr": 2, "fc": 7, "tr": 1, "tc": 7, "fallback": 0}, {"fr": 5, "fc": 0, "tr": 2, "tc": 0, "fallback": 0}, {"fr": 2, "fc": 8, "tr": 2, "tc": 7, "fallback": 0}, {"fr": 9, "fc": 8, "tr": 9, "tc": 7, "fallback": 0}, {"fr": 2, "fc": 7, "tr": 2, "tc": 8, "fallback": 0}, {"fr": 2, "fc": 0, "tr": 2, "tc": 8, "fallback": 0}, {"fr": 0, "fc": 4, "tr": 1, "tc": 4, "fallback": 0}, {"fr": 9, "fc": 1, "tr": 8, "tc": 3, "fallback": 0}, {"fr": 1, "fc": 7, "tr": 1, "tc": 6, "fallback": 0}, {"fr": 6, "fc": 8, "tr": 5, "tc": 8, "fallback": 0}, {"fr": 4, "fc": 5, "tr": 6, "tc": 5, "fallback": 0}, {"fr": 2, "fc": 8, "tr": 0, "tc": 8, "fallback": 0}, {"fr": 6, "fc": 5, "tr": 4, "tc": 5, "fallback": 0}, {"fr": 8, "fc": 3, "tr": 6, "tc": 2, "fallback": 0}, {"fr": 1, "fc": 6, "tr": 9, "tc": 6, "fallback": 0}, {"fr": 9, "fc": 7, "tr": 9, "tc": 6, "fallback": 0}, {"fr": 3, "fc": 8, "tr": 4, "tc": 8, "fallback": 0}, {"fr": 9, "fc": 6, "tr": 9, "tc": 8, "fallback": 0}, {"fr": 1, "fc": 4, "tr": 0, "tc": 4, "fallback": 0}, {"fr": 9, "fc": 8, "tr": 9, "tc": 7, "fallback": 0}, {"fr": 4, "fc": 5, "tr": 4, "tc": 3, "fallback": 0}, {"fr": 9, "fc": 7, "tr": 7, "tc": 7, "fallback": 0}, {"fr": 4, "fc": 3, "tr": 2, "tc": 3, "fallback": 0}, {"fr": 0, "fc": 8, "tr": 0, "tc": 5, "fallback": 0}, {"fr": 0, "fc": 4, "tr": 0, "tc": 5, "fallback": 0}, {"fr": 6, "fc": 0, "tr": 5, "tc": 0, "fallback": 0}, {"fr": 2, "fc": 3, "tr": 8, "tc": 3, "fallback": 0}, {"fr": 7, "fc": 7, "tr": 0, "tc": 7, "fallback": 0}, {"fr": 0, "fc": 5, "tr": 1, "tc": 5, "fallback": 0}, {"fr": 0, "fc": 7, "tr": 0, "tc": 3, "fallback": 0}, {"fr": 4, "fc": 6, "tr": 5, "tc": 6, "fallback": 0}, {"fr": 0, "fc": 3, "tr": 3, "tc": 3, "fallback": 0}, {"fr": 8, "fc": 3, "tr": 8, "tc": 0, "fallback": 0}, {"fr": 3, "fc": 3, "tr": 3, "tc": 4, "fallback": 0}, {"fr": 0, "fc": 1, "tr": 2, "tc": 0, "fallback": 0}, {"fr": 3, "fc": 4, "tr": 2, "tc": 4, "fallback": 0}, {"fr": 0, "fc": 2, "tr": 2, "tc": 4, "fallback": 0}, {"fr": 8, "fc": 4, "tr": 9, "tc": 5, "fallback": 0}, {"fr": 8, "fc": 0, "tr": 8, "tc": 6, "fallback": 0}, {"fr": 9, "fc": 3, "tr": 8, "tc": 4, "fallback": 0}, {"fr": 2, "fc": 4, "tr": 4, "tc": 6, "fallback": 0}, {"fr": 7, "fc": 0, "tr": 9, "tc": 2, "fallback": 0}, {"fr": 1, "fc": 5, "tr": 2, "tc": 5, "fallback": 1}, {"fr": 6, "fc": 2, "tr": 7, "tc": 4, "fallback": 0}, {"fr": 2, "fc": 0, "tr": 1, "tc": 2, "fallback": 1}, {"fr": 5, "fc": 2, "tr": 4, "tc": 2, "fallback": 0}, {"fr": 1, "fc": 2, "tr": 0, "tc": 4, "fallback": 1}, {"fr": 7, "fc": 8, "tr": 8, "tc": 6, "fallback": 0}, {"fr": 2, "fc": 5, "tr": 2, "tc": 4, "fallback": 0}, {"fr": 9, "fc": 0, "tr": 9, "tc": 1, "fallback": 0}, {"fr": 3, "fc": 2, "tr": 4, "tc": 2, "fallback": 0}, {"fr": 9, "fc": 2, "tr": 7, "tc": 0, "fallback": 0}, {"fr": 5, "fc": 6, "tr": 5, "tc": 7, "fallback": 0}, {"fr": 8, "fc": 6, "tr": 7, "tc": 8, "fallback": 0}, {"fr": 0, "fc": 4, "tr": 1, "tc": 2, "fallback": 0}, {"fr": 7, "fc": 8, "tr": 5, "tc": 7, "fallback": 0}, {"fr": 2, "fc": 4, "tr": 2, "tc": 5, "fallback": 0}, {"fr": 8, "fc": 4, "tr": 7, "tc": 5, "fallback": 0}, {"fr": 1, "fc": 2, "tr": 2, "tc": 0, "fallback": 0}, {"fr": 7, "fc": 0, "tr": 5, "tc": 2, "fallback": 0}, {"fr": 4, "fc": 2, "tr": 5, "tc": 2, "fallback": 0}, {"fr": 9, "fc": 1, "tr": 8, "tc": 1, "fallback": 0}, {"fr": 2, "fc": 0, "tr": 0, "tc": 1, "fallback": 0}, {"fr": 8, "fc": 1, "tr": 8, "tc": 8, "fallback": 0}, {"fr": 0, "fc": 1, "tr": 2, "tc": 2, "fallback": 0}, {"fr": 8, "fc": 8, "tr": 9, "tc": 8, "fallback": 0}, {"fr": 4, "fc": 6, "tr": 2, "tc": 8, "fallback": 0}, {"fr": 9, "fc": 4, "tr": 8, "tc": 4, "fallback": 0}, {"fr": 2, "fc": 5, "tr": 2, "tc": 4, "fallback": 0}, {"fr": 5, "fc": 7, "tr": 4, "tc": 5, "fallback": 0}, {"fr": 2, "fc": 4, "tr": 2, "tc": 5, "fallback": 0}, {"fr": 4, "fc": 5, "tr": 3, "tc": 3, "fallback": 0}, {"fr": 2, "fc": 5, "tr": 2, "tc": 4, "fallback": 0}, {"fr": 9, "fc": 8, "tr": 7, "tc": 8, "fallback": 0}, {"fr": 2, "fc": 2, "tr": 1, "tc": 0, "fallback": 0}, {"fr": 5, "fc": 0, "tr": 4, "tc": 0, "fallback": 0}, {"fr": 1, "fc": 0, "tr": 0, "tc": 2, "fallback": 0}, {"fr": 3, "fc": 3, "tr": 1, "tc": 4, "fallback": 0}, {"fr": 3, "fc": 0, "tr": 4, "tc": 0, "fallback": 0}, {"fr": 1, "fc": 4, "tr": 0, "tc": 2, "fallback": 0}, {"fr": 2, "fc": 4, "tr": 2, "tc": 5, "fallback": 0}, {"fr": 0, "fc": 2, "tr": 2, "tc": 1, "fallback": 0}, {"fr": 2, "fc": 5, "tr": 2, "tc": 4, "fallback": 0}, {"fr": 2, "fc": 1, "tr": 4, "tc": 2, "fallback": 0}, {"fr": 4, "fc": 0, "tr": 5, "tc": 0, "fallback": 0}, {"fr": 7, "fc": 8, "tr": 7, "tc": 6, "fallback": 0}, {"fr": 5, "fc": 2, "tr": 5, "tc": 3, "fallback": 0}, {"fr": 5, "fc": 8, "tr": 4, "tc": 8, "fallback": 0}, {"fr": 5, "fc": 3, "tr": 5, "tc": 4, "fallback": 0}, {"fr": 8, "fc": 4, "tr": 9, "tc": 4, "fallback": 0}, {"fr": 5, "fc": 4, "tr": 6, "tc": 4, "fallback": 0}, {"fr": 4, "fc": 2, "tr": 5, "tc": 0, "fallback": 0}, {"fr": 2, "fc": 8, "tr": 4, "tc": 6, "fallback": 0}, {"fr": 7, "fc": 5, "tr": 8, "tc": 4, "fallback": 0}, {"fr": 6, "fc": 4, "tr": 6, "tc": 5, "fallback": 0}, {"fr": 7, "fc": 4, "tr": 8, "tc": 2, "fallback": 0}, {"fr": 4, "fc": 6, "tr": 2, "tc": 8, "fallback": 0}, {"fr": 8, "fc": 2, "tr": 7, "tc": 0, "fallback": 0}, {"fr": 2, "fc": 8, "tr": 0, "tc": 6, "fallback": 0}, {"fr": 7, "fc": 6, "tr": 7, "tc": 2, "fallback": 0}, {"fr": 2, "fc": 4, "tr": 1, "tc": 4, "fallback": 0}, {"fr": 7, "fc": 2, "tr": 1, "tc": 2, "fallback": 0}, {"fr": 1, "fc": 4, "tr": 0, "tc": 4, "fallback": 0}, {"fr": 1, "fc": 2, "tr": 1, "tc": 1, "fallback": 0}, {"fr": 6, "fc": 5, "tr": 7, "tc": 5, "fallback": 0}, {"fr": 1, "fc": 1, "tr": 6, "tc": 1, "fallback": 0}, {"fr": 7, "fc": 5, "tr": 7, "tc": 6, "fallback": 0}, {"fr": 9, "fc": 4, "tr": 9, "tc": 3, "fallback": 0}, {"fr": 7, "fc": 6, "tr": 7, "tc": 7, "fallback": 0}, {"fr": 5, "fc": 0, "tr": 3, "tc": 1, "fallback": 0}, {"fr": 0, "fc": 4, "tr": 0, "tc": 5, "fallback": 0}, {"fr": 8, "fc": 4, "tr": 7, "tc": 5, "fallback": 0}, {"fr": 0, "fc": 5, "tr": 0, "tc": 4, "fallback": 0}, {"fr": 3, "fc": 1, "tr": 1, "tc": 0, "fallback": 0}, {"fr": 0, "fc": 6, "tr": 2, "tc": 4, "fallback": 0}, {"fr": 7, "fc": 0, "tr": 9, "tc": 1, "fallback": 0}, {"fr": 2, "fc": 4, "tr": 4, "tc": 6, "fallback": 0}, {"fr": 4, "fc": 8, "tr": 3, "tc": 8, "fallback": 0}, {"fr": 7, "fc": 7, "tr": 8, "tc": 7, "fallback": 0}, {"fr": 6, "fc": 1, "tr": 6, "tc": 2, "fallback": 0}, {"fr": 8, "fc": 7, "tr": 8, "tc": 6, "fallback": 0}, {"fr": 6, "fc": 2, "tr": 6, "tc": 1, "fallback": 0}, {"fr": 4, "fc": 6, "tr": 2, "tc": 4, "fallback": 0}, {"fr": 6, "fc": 1, "tr": 6, "tc": 7, "fallback": 0}, {"fr": 2, "fc": 4, "tr": 0, "tc": 2, "fallback": 0}, {"fr": 6, "fc": 7, "tr": 6, "tc": 4, "fallback": 0}, {"fr": 0, "fc": 2, "tr": 2, "tc": 4, "fallback": 0}, {"fr": 6, "fc": 4, "tr": 4, "tc": 4, "fallback": 0}, {"fr": 8, "fc": 6, "tr": 9, "tc": 6, "fallback": 0}, {"fr": 9, "fc": 3, "tr": 8, "tc": 3, "fallback": 0}, {"fr": 9, "fc": 6, "tr": 9, "tc": 5, "fallback": 0}, {"fr": 7, "fc": 5, "tr": 8, "tc": 4, "fallback": 0}, {"fr": 0, "fc": 4, "tr": 0, "tc": 5, "fallback": 0}, {"fr": 4, "fc": 4, "tr": 2, "tc": 4, "fallback": 0}, {"fr": 0, "fc": 5, "tr": 1, "tc": 5, "fallback": 0}, {"fr": 2, "fc": 4, "tr": 2, "tc": 3, "fallback": 0}, {"fr": 9, "fc": 5, "tr": 9, "tc": 4, "fallback": 0}, {"fr": 9, "fc": 1, "tr": 7, "tc": 2, "fallback": 0}, {"fr": 1, "fc": 5, "tr": 1, "tc": 4, "fallback": 0}, {"fr": 2, "fc": 3, "tr": 7, "tc": 3, "fallback": 0}, {"fr": 1, "fc": 4, "tr": 0, "tc": 4, "fallback": 0}, {"fr": 3, "fc": 8, "tr": 3, "tc": 7, "fallback": 0}, {"fr": 9, "fc": 4, "tr": 9, "tc": 5, "fallback": 0}, {"fr": 7, "fc": 3, "tr": 7, "tc": 4, "fallback": 0}, {"fr": 0, "fc": 4, "tr": 0, "tc": 5, "fallback": 0}, {"fr": 7, "fc": 2, "tr": 6, "tc": 0, "fallback": 0}, {"fr": 9, "fc": 5, "tr": 9, "tc": 6, "fallback": 0}, {"fr": 7, "fc": 4, "tr": 7, "tc": 7, "fallback": 0}, {"fr": 0, "fc": 5, "tr": 0, "tc": 4, "fallback": 0}, {"fr": 6, "fc": 0, "tr": 4, "tc": 1, "fallback": 0}, {"fr": 0, "fc": 4, "tr": 0, "tc": 5, "fallback": 0}, {"fr": 3, "fc": 7, "tr": 2, "tc": 7, "fallback": 0}, {"fr": 0, "fc": 5, "tr": 1, "tc": 5, "fallback": 0}, {"fr": 7, "fc": 7, "tr": 7, "tc": 2, "fallback": 0}, {"fr": 9, "fc": 6, "tr": 9, "tc": 5, "fallback": 0}, {"fr": 8, "fc": 4, "tr": 9, "tc": 5, "fallback": 0}, {"fr": 1, "fc": 5, "tr": 1, "tc": 4, "fallback": 0}, {"fr": 8, "fc": 3, "tr": 9, "tc": 3, "fallback": 0}, {"fr": 1, "fc": 4, "tr": 2, "tc": 4, "fallback": 0}, {"fr": 4, "fc": 1, "tr": 2, "tc": 2, "fallback": 0}, {"fr": 2, "fc": 4, "tr": 2, "tc": 5, "fallback": 0}, {"fr": 2, "fc": 7, "tr": 1, "tc": 7, "fallback": 0}, {"fr": 2, "fc": 5, "tr": 2, "tc": 4, "fallback": 0}, {"fr": 7, "fc": 2, "tr": 7, "tc": 4, "fallback": 0}, {"fr": 2, "fc": 4, "tr": 2, "tc": 5, "fallback": 0}, {"fr": 2, "fc": 2, "tr": 0, "tc": 1, "fallback": 0}, {"fr": 2, "fc": 5, "tr": 1, "tc": 5, "fallback": 0}, {"fr": 0, "fc": 1, "tr": 2, "tc": 2, "fallback": 0}, {"fr": 1, "fc": 5, "tr": 2, "tc": 5, "fallback": 0}, {"fr": 7, "fc": 4, "tr": 5, "tc": 4, "fallback": 0}, {"fr": 2, "fc": 5, "tr": 1, "tc": 5, "fallback": 0}, {"fr": 1, "fc": 0, "tr": 0, "tc": 2, "fallback": 0}, {"fr": 1, "fc": 5, "tr": 2, "tc": 5, "fallback": 0}, {"fr": 5, "fc": 4, "tr": 5, "tc": 8, "fallback": 0}, {"fr": 2, "fc": 5, "tr": 2, "tc": 4, "fallback": 0}, {"fr": 0, "fc": 2, "tr": 1, "tc": 4, "fallback": 1}, {"fr": 2, "fc": 4, "tr": 2, "tc": 5, "fallback": 0}, {"fr": 5, "fc": 8, "tr": 5, "tc": 1, "fallback": 0}, {"fr": 2, "fc": 5, "tr": 2, "tc": 4, "fallback": 0}, {"fr": 2, "fc": 2, "tr": 1, "tc": 0, "fallback": 0}, {"fr": 2, "fc": 4, "tr": 2, "tc": 5, "fallback": 0}, {"fr": 1, "fc": 4, "tr": 0, "tc": 2, "fallback": 0}, {"fr": 2, "fc": 5, "tr": 2, "tc": 4, "fallback": 0}, {"fr": 5, "fc": 1, "tr": 5, "tc": 7, "fallback": 0}, {"fr": 2, "fc": 4, "tr": 2, "tc": 5, "fallback": 0}, {"fr": 5, "fc": 7, "tr": 5, "tc": 6, "fallback": 0}, {"fr": 2, "fc": 5, "tr": 2, "tc": 4, "fallback": 0}, {"fr": 0, "fc": 2, "tr": 2, "tc": 3, "fallback": 0}, {"fr": 2, "fc": 4, "tr": 2, "tc": 5, "fallback": 0}, {"fr": 2, "fc": 3, "tr": 4, "tc": 2, "fallback": 0}, {"fr": 2, "fc": 5, "tr": 1, "tc": 5, "fallback": 0}, {"fr": 4, "fc": 2, "tr": 2, "tc": 3, "fallback": 0}, {"fr": 1, "fc": 5, "tr": 2, "tc": 5, "fallback": 0}, {"fr": 1, "fc": 0, "tr": 3, "tc": 1, "fallback": 0}, {"fr": 2, "fc": 5, "tr": 2, "tc": 4, "fallback": 0}, {"fr": 5, "fc": 6, "tr": 7, "tc": 6, "fallback": 0}, {"fr": 2, "fc": 4, "tr": 2, "tc": 5, "fallback": 0}, {"fr": 7, "fc": 6, "tr": 7, "tc": 7, "fallback": 0}, {"fr": 2, "fc": 5, "tr": 2, "tc": 4, "fallback": 0}, {"fr": 7, "fc": 7, "tr": 7, "tc": 3, "fallback": 0}, {"fr": 2, "fc": 4, "tr": 1, "tc": 4, "fallback": 0}, {"fr": 2, "fc": 3, "tr": 0, "tc": 4, "fallback": 0}, {"fr": 1, "fc": 4, "tr": 0, "tc": 4, "fallback": 0}, {"fr": 3, "fc": 1, "tr": 2, "tc": 3, "fallback": 0}, {"fr": 0, "fc": 4, "tr": 0, "tc": 5, "fallback": 0}, {"fr": 1, "fc": 7, "tr": 0, "tc": 7, "fallback": 1}]};
  const states = payload.states || [];
  const moves = payload.moves || [];
  const meta = payload.meta || {};

  // UI meta
  for (const [k,v] of Object.entries(meta)) {
    const el = document.getElementById(k);
    if (el) el.textContent = String(v ?? '');
  }
  // Pretty result text: 红胜/黑胜/和棋
  function prettyResult(meta) {
    if (meta && typeof meta === 'object') {
      if (meta.winner === 'r') return '红胜';
      if (meta.winner === 'b') return '黑胜';
      if (meta.result === 0) return '和棋';
      if (meta.result === 1) return '胜';
      if (meta.result === -1) return '负';
    }
    return '';
  }
  const resEl = document.getElementById('result');
  if (resEl) {
    const txt = prettyResult(meta);
    if (txt) resEl.textContent = txt;
  }
  document.getElementById('total').textContent = String(Math.max(0, states.length-1));

  // Mapping letters to Chinese pieces (same as frontend)
  const TEXT = {K:'帅',A:'仕',E:'相',H:'马',R:'车',C:'炮',S:'兵',k:'将',a:'士',e:'象',h:'马',r:'车',c:'炮',s:'卒'};

  const ctx = document.getElementById('board').getContext('2d');
  const GRID_W = 60, GRID_H = 60, ORIGIN_X = 30, ORIGIN_Y = 30;
  if (!CanvasRenderingContext2D.prototype.roundRect) {
    CanvasRenderingContext2D.prototype.roundRect = function(x, y, w, h, r) {
      const min = Math.min(w, h) / 2; r = Math.min(r, min);
      this.beginPath(); this.moveTo(x + r, y);
      this.arcTo(x + w, y, x + w, y + h, r);
      this.arcTo(x + w, y + h, x, y + h, r);
      this.arcTo(x, y + h, x, y, r);
      this.arcTo(x, y, x + w, y, r); this.closePath(); return this;
    }
  }

  function parseFen(fen) {
    const [rows, stm] = fen.trim().split(' ');
    const lines = rows.split('/');
    const b = Array.from({length:10},()=>Array(9).fill('.'));
    for(let r=0;r<10;r++){
      let c=0; for(const ch of lines[r]){
        if(/[1-9]/.test(ch)){ c += parseInt(ch,10); }
        else { b[r][c++] = ch; }
      }
    }
    return {board:b, stm};
  }

  function drawLine(c1,r1,c2,r2){
    ctx.beginPath();
    ctx.moveTo(ORIGIN_X + c1*GRID_W, ORIGIN_Y + r1*GRID_H);
    ctx.lineTo(ORIGIN_X + c2*GRID_W, ORIGIN_Y + r2*GRID_H);
    ctx.strokeStyle=getComputedStyle(document.documentElement).getPropertyValue('--line').trim();
    ctx.lineWidth=2; ctx.stroke();
  }

  function drawBoard(){
    const canvas = document.getElementById('board');
    ctx.clearRect(0,0,canvas.width,canvas.height);
    // Outer frame
    ctx.strokeStyle = getComputedStyle(document.documentElement).getPropertyValue('--line').trim(); ctx.lineWidth=2;
    ctx.strokeRect(ORIGIN_X-5, ORIGIN_Y-5, GRID_W*8+10, GRID_H*9+10);
    // Grid lines
    ctx.beginPath();
    for(let r=0;r<10;r++){
      const y = ORIGIN_Y + r*GRID_H;
      ctx.moveTo(ORIGIN_X, y);
      ctx.lineTo(ORIGIN_X + GRID_W*8, y);
    }
    // Vertical lines (break at river)
    for(let c=0;c<9;c++){
      const x = ORIGIN_X + c*GRID_W;
      ctx.moveTo(x, ORIGIN_Y);
      ctx.lineTo(x, ORIGIN_Y + GRID_H*4);
      ctx.moveTo(x, ORIGIN_Y + GRID_H*5);
      ctx.lineTo(x, ORIGIN_Y + GRID_H*9);
    }
    ctx.stroke();
    // Palace diagonals
    drawLine(3,0,5,2); drawLine(5,0,3,2);
    drawLine(3,7,5,9); drawLine(5,7,3,9);
    // River text
    ctx.fillStyle = '#a08866'; ctx.font = '16px serif';
    ctx.fillText('楚河', ORIGIN_X + GRID_W*1.5, ORIGIN_Y + GRID_H*4.6);
    ctx.fillText('汉界', ORIGIN_X + GRID_W*5.5, ORIGIN_Y + GRID_H*4.6);
  }

  function rect(c,r,rad,color){
    const x = ORIGIN_X + c*GRID_W; const y = ORIGIN_Y + r*GRID_H;
    ctx.beginPath(); ctx.roundRect(x-rad,y-rad,rad*2,rad*2,6); ctx.fillStyle=color+'55'; ctx.fill();
  }

  function drawPiece(c,r,p){
    const x = ORIGIN_X + c*GRID_W; const y = ORIGIN_Y + r*GRID_H;
    ctx.save();
    // Disk
    ctx.beginPath(); ctx.arc(x,y,23,0,Math.PI*2);
    ctx.fillStyle = '#fffdf7'; ctx.fill();
    ctx.strokeStyle = '#cbb79c'; ctx.lineWidth=2; ctx.stroke();
    // Text
    const red = (p===p.toUpperCase());
    const color = getComputedStyle(document.documentElement).getPropertyValue(red?'--red':'--black').trim();
    ctx.fillStyle = color; ctx.font = '20px serif'; ctx.textAlign='center'; ctx.textBaseline='middle';
    ctx.fillText(TEXT[p]||'?', x, y+1);
    ctx.restore();
  }

  function renderBoard(fen, lastMove){
    const { board } = parseFen(fen);
    drawBoard();
    if (lastMove) { rect(lastMove.tc, lastMove.tr, 26, '#4fc3f7'); rect(lastMove.fc, lastMove.fr, 26, '#ffd54f'); }
    for(let r=0;r<10;r++){
      for(let c=0;c<9;c++){
        const p = board[r][c]; if(p==='.') continue; drawPiece(c,r,p);
      }
    }
  }

  let cur = 0; // state index
  let timer = null;
  function show(i) {
    cur = Math.max(0, Math.min(i, states.length-1));
    const last = cur > 0 ? moves[cur-1] : null;
    renderBoard(states[cur], last);
    document.getElementById('step').textContent = String(cur);
  }
  function start() {
    if (timer) return;
    timer = setInterval(() => {
      if (cur >= states.length-1) { pause(); return; }
      show(cur+1);
    }, 5000); // 5 seconds per move
  }
  function pause() { if (timer) { clearInterval(timer); timer = null; } }

  document.getElementById('btnStart').onclick = start;
  document.getElementById('btnPause').onclick = pause;
  document.getElementById('btnPrev').onclick = () => show(cur-1);
  document.getElementById('btnNext').onclick = () => show(cur+1);

  // initial render
  show(0);
  </script>
</body>
</html>
